\chapter{Převedení na optimalizační úlohu}

\section{Formalizace problému}

Ústředním problémem pohotovostních služeb je umět naplánovat týmy záchranářů a záchranná vozidla na výjezdové stanice tak, aby úspěšně obsloužili co největší počet incidentů,
za co nejméně zbytečně vynaložených nákladů.
Našim cílem je vymyslet metody jak být schopný taková optimální naplánovaní nalézt.
Z toho důvodu je v první řadě potřeba si problém zformalizovat a jasně si tak vymezit, jaký konkrétní problém řešíme.
\\
\\
Pohotovostní služba má k dispozici týmy záchranářů $Z$, pohotovostní vozidla $A$ a výjezdové stanice $V$.
Tým záchranářů $z \in Z$ je na výjezdové stanici $v \in V$ k dispozici v rámci svoji přiřazené pracovní směny $d \in D$,
kde $D \subseteq (\mathbb{N}_0, \mathbb{N}_0)$ jsou všechny možné pracovní směny dané pohotovostní službou.
Směna $d \in D$ je tak dvojice $d = (d_1, d_2)$, kde $d_1$ značí začátek a $d_2$ délku trvání pracovní směny v sekundách.
\\
\\
Plán pohotovostní služby $p \in P$ je přiřazení záchranných vozidel $a \in A$ a týmů záchranářů $z \in Z$ na konkrétní výjezdové stanice $v \in V$
a přiřazení pracovní směny $d \in D$ každému týmu záchranářů $z \in Z$ v rámci jednoho dne, kde $P$ je množina všech plánů pohotovostní služby.
Tato přiřazení popíšeme funkcemi, 

\begin{align}
  p_D \colon Z &\rightarrow D \\
  p_Z \colon Z &\rightarrow V \cup \{ v_{\emptyset} \} \\
  p_A \colon A &\rightarrow V \cup \{ v_{\emptyset} \}
\end{align}
.
\\
\\
Plán pohotovostní služby pak je trojice,

\begin{align}
  p = (p_D, p_Z, p_A) \in P
\end{align}
.
\\
\\
Pohotovostní služba dále definuje omezení $C = \{ C_Z, C_A \}$, kde $C_Z$ je maximální dovolený počet $z \in Z$ na libovolné $v \in V$
a $C_A$ je maximální dovolený počet $a \in A$ na libovolné $v \in V$.
Nechť pak $P_C \subseteq P$ množina plánů splňující omezující podmínky $C$, tedy

\begin{align}
  p_C = (p_{D_C}, p_{Z_C}, p_{A_C}) \in P_C
\end{align}

\clearpage

, kde

\begin{align}
  p_{D_C} \colon Z &\rightarrow D \\ 
  p_{Z_C} \colon Z &\rightarrow V \cup \{ v_{\emptyset} \},     \hspace{50pt} \text{splňující $C_Z$} \\
  p_{A_C} \colon A &\rightarrow V \cup \{ v_{\emptyset} \},     \hspace{50pt} \text{splňující $C_A$}
\end{align}
.
\\
\\
Pokud $z \in Z$ nebo $a \in A$ nemá mít přiřazenou žádnou výjezdovou stanici, tak $p_{Z}(z) = v_{\emptyset}, p_{A}(a) =  v_{\emptyset}$
a stejně tak pro $p_{Z_C}(z) = v_{\emptyset}$ a $p_{A_C}(a) = v_{\emptyset}$.
\\
\\
Problém, který v této práci řešíme, je nalézt $p_C \in P_C$, takové, že úspěšně odbaví co největší počet incidentů za co nejmenší cenu plánu.
Co je úspěšně odbavený incident a jakým způsobem zjistíme kolik incidentů plán úspěšně odbaví je detailně popisováno v kapitole Simulace plánu pohotovnostní služby (odkaz).
Jak zjistíme cenu plánu je popsáno (odkaz).
Formalizace optimalizační úlohy je popsána (odkaz).

\section{Simulace plánu pohotovostní služby}

\subsection{Proč simulace?}

Našim cílem je umět nalézt nejoptimálnější plán pohotovostní služby.
Ten určujeme podle co největšího počtu úspěšně odbavených incidentů a ceny plánu.
Z toho důvodu jsme si formálně nadefinovali protředky, které má pohotovostní služba k dispozici a co je plán pohotovostní služby.
Nyní potřebujeme způsob, jakým zjistíme počet úspěšně odbavených incidentů $S_{pI}$ pohotovostního plánu $p$ na množine incidentů $I$.
Pro zjištění $S_{pI}$ spustíme simulaci $S$ pohotovostního plánu $p$ na množině $I$.
Následně formálně popíšeme jaký typ simulace a jaká pravidla chodu simulace se rozhodneme použít. %TODO odkazy
\\
\\
Je velmi důležité, aby počet úspěšně odbavených incidentů $S_{pI}$ získaných simulací co nejvíce odpovídal počtu úspěšně odbavených incidentů,
kdyby byl použit $p$ v reálném světě a v průběhu dne by se přesně děly incidenty $I$.
Není lepší způsob jak získat co nejdůvěryhodnější $S_{pI}$ než spustit simulaci, která bude co nejvíce odpovídat chování plánu v reálném světě.
\\
\\
Přístup použití simulace má ještě jednu podstatnou výhodu.
Různé pohotovostní služby mohou používat různé způsoby a pravidla, například pro výběr záchranného týmu a vozidla pro odbavení incidentu co právě nastal, nebo do jaké nemocnice incident odbavit.
Tato pravidla můžou být příliš složitá, aby je bylo možné výstižně zachytit jinými způsoby, jako například pouze matematickými rovnostmi a nerovnostmi, jak je zvykem pro lineární programování.
Simulace tak nabízí vysokou flexibilitu.
%TODO, odkaz na linearni programovani kde vice popisu%
\\
\\
Avšak podstatnou nevýhodou simulace je její výpočetní náročnost a poměrně značné omezení použitelných technik obecně využívané pro řešení optimalizačních problémů. %TODO odkaz na optimalizacni ulohu.

\subsection{Definice diskrétní simulace}

\textit{Simulace} je imitace operací nějakého procesu nebo systému z reálného světa v průběhu časového úseku. (Discrete event simulation system simulation) %TODO cituj.
\textit{Systém simulace} je chápan jako dobře definovaná kolekce objektů a interakcí mezi nimi. (cituj ) % https://books.google.cz/books?hl=en&lr=&id=3seWwhxuGhsC&oi=fnd&pg=PA1&dq=discrete+event+simulation+model&ots=L3EkFOZNPK&sig=XrvmwmLnN7SLY0vLla_9yt5-C9Y&redir_esc=y#v=onepage&q=discrete%20event%20simulation%20model&f=false
% strana 2
Simulace si držuje \textit{stav systému}. Ten definuje jak se má simulace chovat.
Systém simulace se může měnit průběhem simulace nebo při nastání \textit{události}.
\\
\\
Simulace obecně dělíme na \textit{spojité} a \textit{diskrétní}.
V \textit{spojité simulaci} se změny systému dějí kontinuálně v průběhu běhu simulace, nejčastěji podle soustavy diferenciálních rovnic.
V \textit{diskrétní simulaci} se změny sytému dějí v diskrétních časoých úsecích, nejčastěji v čase nastání nějaké \textit{události}.
Klasický způsob jak diskrétní simulace probíhá je následovný.
Simulace odbavuje údalosti v pořadí nastání v čase.
Při inicializaci si naplánuje nějaké údalosti.
Při odbavování události aktualizuje stav systému podle předchozího stavu systému a aktuálně odbavované události. Zároveň si simulace náplanuje další události. 
Simulace skončí jakmile nejsou žádné další události k odbavení.
\\
\\
Dále dělíme simulace na \textit{deterministcké} a \textit{stochastické}.
V \textit{deterministické simulaci} jsme schopni z aktuálního stavu systému a údalosti deterministicky určit nadcházející stav systému.
V \textit{stochastické simulaci} nejsme schopni z aktuálního stavu systému a údalosti deterministicky určit nadcházející stav systému.
Většinou proto, že při výběru nadhcázejícího stavu figuruje element náhody.

\clearpage

\subsection{Popis simulace plánu pohotovostní služby}

Definujme simulaci pohotovostního plánu $p \in P_C$ na množině incidentů $I$ jako deterministickou diskrétní simulaci
$S \colon (p_C, I) \rightarrow \mathbb{N}_0$, kde vstupem je plán $p_C \in P_C$ a množina incidentů $I$.
Simulace vrátí počet úspěšně odbavených incidentů $S_{pI} \colon 0 \leq S_{pI} \leq |I|$.
Událost je nastání incidentu $i \in I$ v čase $T_I(i)$, kde $T_I \colon I \rightarrow \mathbb{N}_0$, určuje čas nastání incidentu.
Stav systému simulace $S$ je množina $S_S = \{ S_A, S_Z \}$, kde $S_A$ je stav záchranných vozidel $A$ a $S_Z$ je stav týmů záchranářů $Z$. 

\begin{algorithm}
  \begin{algorithmic}[1]  % [1] způsobí, že číslujeme kroky algoritmu
  \Function{Simulation}{$p_C, I$}
    \State $S_{pI} \gets 0$
    \State $T$ \gets 0
    \State $I' \gets \mbox{Setřídí $I$ podle času nastání, pomocí $T_I$}$
    \State $S_A \gets \mbox{Inicializuje podle $p_C$}$
    \State $S_Z \gets \mbox{Inicializuje podle $p_C$}$
    \For{$i_k \in I',~ k \in \{1, 2, \dots , |I|\}$}
      \State $T \gets \mbox{Čas nastání $i_k$, $T_I(i_k)$}$
      \State $z_k \gets \mbox{GetBestTeam($i_k, S_A, S_Z, T$)}$
      \If{$z_k \neq \emptyset$}
        \State $S_{pI} \gets S_{pI} + 1$
        \State $a_k \gets \mbox{GetBestAmbulance($z_k, T$)}$
        \State Naplánuj($z_k, a_k, i_k$)
        \State $S_A \gets \mbox{Update($S_A, i_k$)}$
        \State $S_Z \gets \mbox{Update($S_Z, i_k$)}$
      \EndIf
    \EndFor
    \State \Return $S_{pI}$
  \EndFunction
  \end{algorithmic}
\end{algorithm}
\vspace*{25px}

Průběh simulace je následovný. 
První simulace položí $S_{pI}$ a $T$ rovno nule.
Následně si setřídí sadu incidentů podle časů nastání a incicializuje si stavy $S_A$ a $S_Z$ podle plánu $p_C$.
Dále simulace odbavuje události, takže se pohybuje po těchto časech od nejdřívějšího až po poslední incident.
V každém kroku simulace $k \in \{ 1, 2, \dots , |I|\}$ se první pokusí deterministicky nalézt nejvhodnější $z_k \in Z$, který obslouží $i_k$. 
Pokud takový $z_k$ neexistuje, tak pokračuje v odbavování dalších incidentů.
Pokud existuje, zvýší počet odbavených incidentů $S_{pI}$ o jedna, nalezne pro $z_k$ nejvhodnější $a_k$, $i_k$ naplánuje na $z_k$ spolu s $a_k$ a aktualizuje stav systému $S_A$ a $S_Z$.
Simulace doběhne jakmile nejsou žádné další události k odbavení, takže jakmile projde všechny incidenty, to je po $|I|$ krocích, a vrátí $S_{pI}$.
\\
\\
Nyní si ukažme, jakým způsobem je nalezen nejvhodnější tým záchranářů $z_k$ pro obsloužení $i_k$. K tomu si potřebujeme definovat co znamená,
že tým záchranářů je schopen úspěšně odbavit incident a jakým způsobem pak vybere ze všech takových týmu ten nejvhodnější.

\clearpage

\begin{definice}
  Tým záchranářů $z \in Z$ je schopen úspěšně odbavit incident $i \in I$ právě tehdy když:

  \begin{enumerate}
    \item
      Je alokován a má přiřazenou směnu. Pokud tým záchranářu není alokován na žádnou výjezdovou stanici nebo nemá přiřazenou směnu, tak samozřejmě není schopen obsloužit $i$.
      Formálně, $p_{Z_C} \neq 0 \land p_{D_C} \neq (d_1, d_2) \in D, d_2 = 0$.

    \item
      Tým je schopen dorazit na místo incidentu do požadované doby.
      Ať už přímo z výjezdové stanice, nebo při vrácení se po vyřízení incidentu zpět na výjezdovou stanici. 
      V prvním případě tým potřebuje mít na výjezdové stanici k dispozi volné záchranné vozidlo. V druhém případě už záchranné vozidlo k dispozici má.

    \item
      Týmu nekončí směna dříve, než je očekávaný konec celkové doby vyřízení incidentu.
  \end{enumerate}
\end{definice}


\begin{definice}
  Nejvhodnější tým záchranářů $z_k \in Z_k$, kde $Z_k \subseteq Z$ jsou všechny týmy záchranářů schopny úspěšně odbavit incident $i_k \in I$ je tým,
  který je nejlepší podle následujícíh kritérií v daném pořadí:

  \begin{enumerate}
    \item Upřednostni tým, který je na výjezdové stanici před týmem, který ukončuje vyřízení jednoho z předchozích incidentů. 
    \item Upřednostni tým, který na místo incidentu dorazí dříve. 
    \item Upřednostni tým, který již obsloužil méně incidentů a je tedy méně vyčerpaný.
  \end{enumerate}
\end{definice}

Funkce \textbf{GetBestTeam} vrací tým záchranářu $z_k$ z týmů záchranářů $Z_k$, kteří jsou schopni úspěšně odbavit incident $i_k$, podle (Definice 1)
, kde $z_k$ je nejvhodnější pro obsloužení incidentu $i_k$ ze $Z_k$ podle definice 2. %TODO odkaz
Funkce \textbf{GetBestAmbulance} vybere záchranné vozidlo, které je na stejné výjezdové stanici jako $z_k$ a časově je nejdříve k dispozici.
%TODO jak odkazat do kodu?
\\
\\
Pravidla jsou navrhnuta tak, aby práce obsluhování incidentů byla rozmístěna rovnoměrně přes všechny týmy, ale aby zároveň byly incidenty obslouženy nejrychleji jak je možné.
Třetí pravidlo pro výběr nejvhodnějšího týmu zaručuje rovnoměrnost práce a druhé co nejrychlejší obsloužení incidentu.
Pravidla také počítají s možným zpožděním a raději upřednostní tým, který je aktuálně k dispozici, než tým, který ještě dokončuje jiný incident, ale mohl by i na místě incidentu
být dříve, pokud by neměl zpoždění. Příkladem je první pravidlo pro výběr nejvhodnějšího týmu.
\\
\\
V naší simulaci jsou použitá pravidla vybraná na základě konzultace se společností, která se danou problematikou zabývá přes 25 let a sami podobná pravidla používají pro plánovaní sanitek
u několika jejich klientů ve Spojených státech.
Není však problém naimplementovat pravidla zcela jiná, jednodušší, komplikovanější nebo klidně i stochastická.

\section{Optimalizační úloha}

\subsection{Popis problému jako optimalizační úloha s více účelovými funkcemi}

\begin{definice}[Optimalizační úloha s jednou účelovou funkcí]
  \begin{align}
    \max_{x} q(x), \hspace{50pt} x \in \mathcal{X},
  \end{align}
  \\
  kde $\mathcal{X}$ je prostor všech možných konfigurací.
\end{definice}

Za \textit{řešení} optimalizační úlohy se považuje optimální konfigurace $x^* \in \mathcal{X}$, kde $q(x^*)$ je globální maximum $q$.
Funkce $q$ je účelová funkce, a její návrh zásadně ovlivní jaké $x^*$ je optimální. 
\\
\begin{definice}[Optimalizační úloha s více účelovými funkcemi]
  \begin{align}
    \max_{x} q(x), \hspace{50pt} x \in \mathcal{X}, q \in \mathcal{Q}
  \end{align}
  \\
  kde $\mathcal{X}$ je prostor všech možných konfigurací a $\mathcal{Q}$ je množina účelových funkcí, které chceme maximalizovat.
  Bez újmy na obecnosti můžeme účelové funkce maximalizovat, protože
  \begin{align}
    \min_{x} q(x) \equiv \max_{x} -q(x)
  \end{align}
  .
\end{definice}

Z definice není vůbec jasné, jaká konfigurace $x^* \in \mathcal{X}$ je řešením optimalizační úlohy s více účelovými funkcemi.
Zřejmě maximalizování $q_1 \in \mathcal{Q}$ může minimalizovat $q_2 \in \mathcal{Q}, q_2 \neq q_1$. Tímto se zabýváme (ODKAZ).
\\
\\
Již z úvodu víme, že chceme nalézt takový plán $p_C \in P_C$, který úspěšně odbaví co nejvíce incidentů za co nejmenší cenu plánu.
Díky simulaci $S$ jsme pro $p_C$ schopni zjistit počet úspěšně odbavených incientů $S_{pI}$, potřebujeme ještě dodefinovat cenu plánu.
\\
\begin{definice}[Cena plánu]
  Cena plánu $G \colon P_C \rightarrow \mathbb{R}$,

  \begin{align}
    G(p_C) = \sum_{(d_1, d_2) = p_{D_C}(z), z \in Z} d_2 / 60 + |p_{A_C}(a) \neq v_{\emptyset}|
  \end{align}
  .
  \\
  \\
  Cena plánu je součet všech dob trvání směn přiřazených záchranným týmům v minutách a počtu naalokovaných záchranných vozidel.
\end{definice}

Nadefinujme optimalizační úlohu nalezení optimálního plánu pohotovostní služby, jako
\\
\begin{definice}[Optimalizační úloha nalezení optimálního plánu pohotovostní služby jako optimalizační úloha s více účelovými funkcemi]
  \begin{align}
    &\max_{p_C} S(p_C, I), \hspace{50pt} &p_C &\in P_C \\ 
    &\max_{p_C} -G(p_C), \hspace{50pt}    &p_C &\in P_C,
  \end{align}
  \\
  kde $P_C$ je množina všech povolných plánu pohotovostní služby podle omezení $C$ a $I$ je daná množina incidentů.
\end{definice}

\subsection{Převod na optimalizační úlohu s jednou účelovou funkcí}

\subsection{Návrh účelové funkce}

Díky možnosti spuštění simulace $S$ pohotovostního plánu $p_C$ pro množinu incidentů $I$ jsme schopni získat důležitou statistiku, a to počet úspěšně odbavených incidentů $S(p_C, I)$,
které důvěrně odpovídají reálnému fungování plánu. Zároveň jsme si v předchozí kapitole %TODO odkaz
nadefinovali cenu plánu $G(p_C)$. V této kapitole se budeme věnovat návrhu účelové funkce, která bude vhodně používat $S(p_C, I)$ a $G(p_C)$.
\\
\\
Existuje několik způsobů, jak převést optimalizační úlohu s více účelovými funkcemi

\begin{definice}[Účelová funkce]
Nechť účelová funkce $q_I \colon P_C \rightarrow \mathbb{R}$, která ohodnotí $p \in P_C$ pro danou množinu incidentů $I$,
  \begin{align}
    q_I(p) = \alpha \cdot S(p, I) - (1 - \alpha) \cdot G(p), \hspace{50pt} \alpha \in [0, 1], p \in P_C
  \end{align}
  .
\end{definice}

Účelovou funkci $q_I$ jsme nadefinovali tak, aby nabývala vyšších hodnot při vyšší úspěšnosti odbavených incidentů a nižších hodnot při nižší cenně plánu, a naopak.
To znamená, že pro plány $p$ s vyšším počtem odbavených incientů a nižší cenou bude $q_I(p)$ vyšší
a pro plány s nižším počtem úspěšně odbavených incidentů a vyšší cenou bude $q_I(p)$ nižší.
\\
\\
Zároveň díky parametru $\alpha \in [0, 1]$ můžeme snadno upřednostit buď $S(p, I)$ nebo $G(p)$.
Pro vyšší hodnoty $\alpha$ bude $q_I$ upřednostňovat $S(p, I)$ nad $G(p)$ a pro nižší naopak.
Pro naše účely nastavíme $\alpha$ blíž 1, například $0.99$, protože vždy chceme upřednostnit plány, které úspěšně odbavý co nejvíce incidentů, a až pak nás bude zajímat cena plánu. 
\\
\\
S definicí účelové funkce můžeme nadefinovat optimalizační úlohu, kterou budeme řešit.

\begin{definice}[Optimalizační úloha]
  \begin{align}
    \max_{p_C} q_I(p_C), \hspace{50pt} p_C \in P_C,
  \end{align}
\end{definice}

Plán $p^* \in P_C$, kde $q_I(p^*)$ je globálním maximem je náš hledaný optimální plán.

\section{Klasifikace optimalizační úlohy}

Jedná se o diskrétní kombinatorickou optimalizaci s omezujícími podmínkami $C$, kde víceúčelová funkce $q_I$ pro výpočet kvality plánu používá úspěšnost
odbavení incidentů $s_pI$ a cenu $c_pI$ plánu, pronásobené váhami $\alpha, \beta \in [0, 1]$,
přičemž pro získání $s_pI$ pro $p \in P_C$ a $I$ je nutné spustit simulaci $S_I$.
Funkce $S_I$ nemá žádný matematický předpis, z toho důvodu $q_I$ není derivovatelná.
Nemůže tak splňovat podmínky optimalizace prvního (1.5) ani druhého řádu (1.6) %TODO cituj a odkaz

\begin{align}
  &\nabla q_I(p^*) = 0 \\
  &\nabla^2 q_I(p^*) \hspace{50pt} \text{je positivně semidefinitní}
\end{align}
.
\\
\\
Z toho plyne, že pro nalezení optima nelze použít žádné metody prvního ani druhého řádu. %TODO cituj
Na víceúčelovou funkci $q_I$ můžeme pouze nahlížet jako na černou skříňku %TODO neni neformalni?
, ze které jedině můžeme získávat vzorky v diskrétních bodech.
Zřejmě nemůžeme navzorkovat $q_I$ přes všechny $p \in P_C$ a vybrat z nich maximum, protože obecně $P_C$ je příliš velká.
Kokrétně, velikost $P_C$ se odvíjí od počtu výjezdových stanic $v = |V|$, počtu záchranných vozidel $a = |A|$, počtu záchranných týmů $z = |Z|$, počtu možných směn $d = |D'|$, 
maximálního počtu týmů na stanici $c_z$ a maximálního počtu sanitek na stanici $c_a$.

\begin{align}
  \sum_{i=0}^{z}{d^{v \cdot c_z \choose z - i}} \cdot \sum_{i = 0}^{a}{v \cdot c_a \choose a - i}
\end{align}
\\
\\
Toto (1.7) %odkaz
přesně odpovídá velikosti prostoru dovolených plánu $P_C$. Vybíráme ($z-i$)-tice přes počet stanic a dovolený počet týmů na stanici, a ještě každému týmu
přiřadíme směnu, kterých je $d$. Pro každé takové rozmístění týmů ještě potřebujeme vybrat rozmístění záchranných vozidel.
Způsob výběru je stejný, akorát nepočítáme přiřazení směny.

\clearpage

Odhadneme,

\begin{align*}
  \sum_{i=0}^{z}{d^{v \cdot c_z \choose z - i}} \cdot \sum_{i = 0}^{a}{v \cdot c_a \choose a - i}
  &< z \cdot d^{\left( \frac{v \cdot c_z \cdot 2^{v \cdot c_z}}{e} \right)} \cdot a \cdot {\frac{v \cdot c_a \cdot 2^{v \cdot c_a}}{e}}\\
  &< z \cdot d^{v \cdot c_z \cdot 2^{v \cdot c_z}} \cdot a \cdot {v \cdot c_a \cdot 2^{v \cdot c_a}}\\
  &\sim \mathcal{O}(z \cdot d^{v \cdot 2^v} \cdot av \cdot 2^v)\\
\end{align*}
.
\\
\\
Použitím odhadu kombinačního čísla prostředním, největším, kombinačním číslem přes sčítání velikosti disjunktních množin a následnými úpravami,
dostaneme, že $|P_C| \sim \mathcal{O}(z \cdot d^{v \cdot 2^v} \cdot av \cdot 2^v)$.
Na $c_z$ a $c_a$ nahlížíme jako na konstanty, protože v praxi se o konstanty jedná. Jedná se o řádově těsný odhad, takže jistě existuje $c_1$, aby $|P_C| \sim \Omega(z \cdot d^{v \cdot 2^v} \cdot av \cdot 2^v)$.
Takže 

\begin{align*}
  |P_C| \sim \Theta{(z \cdot d^{v \cdot 2^v} \cdot av \cdot 2^v)}
\end{align*}
.
\\
\\
Prostor plánu je exponenciálně velký vůči násobku počtu výjezdových stanic $v$ a počtu možných směn $d$.
\\
\\
Časová složitost běhu jedné simulace pro množinu incidentů $I$ je $\sim \Theta{(|I| \cdot z \cdot c_a})$.
Potřebujeme pro každý incident nalézt nejvhodnější tým a pro daný tým nejvhodnější záchranné vozidlo na výjezdové stanici, kde se tým nachází.
\\
\\
Časová složitost přeiterování přes všechny plány a spuštění simulace je

$$
  \Theta{(z \cdot d^{v \cdot 2^v} \cdot av \cdot 2^v \cdot |I| \cdot z \cdot c_a)}
$$
.
\\
\\
Zřejmě tedy nelze naivně zkusit spustit simulaci pro každý plán $p \in P_C$, držet si $p^*$ s maximální hodnotou účelové funkce a tak najít nejkvalitnější plán.
\\
\\
Dále, nelze ani v rozumném čase zjistit maximální kvalitu plánu, protože ani nelze v rozumném čase zjistit maximální možnou úspěšnost.
Uvažme množinu plánů $P_{max} \subseteq P_C$, obsahující pouze plány s maximální délkou směny $d_{max} \in D$ a uvažme sitauci kdy máme dostatek záchranných týmů i vozidel,
takže na každé výjezdové stanici jich máme maximální počet.
\\
\\
Nechť $p*_{max} \in P_{max}$, $S_{I}(p*_{max}) = s_{max}$.
Pokud $\forall p_{max} \in P_{max} \colon S_{pI}(p_{max}) \leq s_{max}$, pak jistě $\forall p \in P_C \colon S_{pI}(p) \leq s_{max}$.
Zřejmě pokud mezi plány s maximální délkou směny pro všechny týmy a maximálním počtem týmů a vozidel přes stanice nalezneme $s_{max}$,
pak se jedná i o maximální možnou úspěšnost přes všechny možné plány. S kratšími délkami směn si pomůžeme se snížením ceny, avšak v úspěšnosti si můžeme jedině uškodit.
Jenže $|P_{max}| \geq d^z$. Hodnota $d$ se v praxi pohybuje kolem nižších desítek a $z$ nižších stovek,
takže očividně i velikost $P_{max}$ je prakticky příliš velká na lineární průchod a tak nalezení maxima.
Zároveň pokud $s'_{max}$ maximem $P'_{max} \subseteq P_{max}$, nemůžeme nikdy prohlásit za maximum $P_{max}$, protože vždy může existovat $p_{max}* \in P_{max} \setminus P'_{max}$ s vyšší kvalitou.
Čili $P_{max}$ je nejmenší možná množina kterou musíme proiterovat pro nalezení plánu s nejvyšší úspěšností s jistotou.
Z toho plyne, že nelze získat ani maximální kvalitu plánu, takže kvality plánu můžeme porovnávat pouze mezi sebou, nikoliv jak blízko jsou nejlepší možné kvalitě.

DDDDDDDDDDdddd
Definujme počet úspěšně odbavených incidentů, $S_c(p, I)$.
Definujme $S_s(p, I)$ jako procento úspěšně odbavených incidentů, tedy

\begin{align}
  S_s(p, I) = \frac{S_c(p, I)}{|I|}.
\end{align}
.
\\
\\
Celkové vynaložené náklady vyjádříme cenou plánu.
Nechť 

