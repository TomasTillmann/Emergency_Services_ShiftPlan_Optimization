\setlength{\parindent}{0pt}

\chapter{Introduction}

\section{Problem definition}

One of the primary challenges faced by emergency medical service providers
(EMS) revolves around determining the optimal availability schedule for their
ambulances at specific depots. The primary objective is to maximize the number
of successfully handled incidents while minimizing the operational costs
associated with the ambulances. This allocation of ambulances and their
availability is commonly referred to as a shift plan.

A shift plan entails assigning shifts and ambulances for a given time interval,
typically a single day. It serves as a representation of when ambulances are
available throughout the day.

Each shift represents a time interval during which an ambulance crew operates
the vehicle, rendering it available for emergency response. Ambulance crews may
possess specialized skills or equipment, such as the inclusion of a doctor or
experienced personnel. Similarly, different ambulances can vary in size or
possess advanced medical tools. To capture these distinctions, each ambulance
is assigned a specific type.

Ambulance types provide an abstraction of these varying scenarios and specify
the incidents they are equipped to handle. For instance, certain incidents may
require specific tools or a larger ambulance. Consequently, only select
ambulances may be suitable for handling such incidents. Ultimately, our primary
concern int this regard is determining whether a given ambulance can
effectively respond to a particular incident, based on the mapping between
ambulance types and incident types. Hence such abstraction is sufficient for
our purposes.

Throughout the day, only one shift can be assigned to each ambulance, and there
may be instances where no shift is assigned, rendering the ambulance
unavailable for the day and unable to participate in incident response.

A shift plan incurs a cost, which we aim to minimize. This cost is determined
by the duration of the shift and the associated cost of the ambulance type.

In evaluating the performance of a shift plan, we measure its effectiveness in
handling a set of incidents. This set represents the spatial and temporal
distribution of incidents that occur within a day. We can obtain such incident
sets through two main approaches.

The first approach involves leveraging historical data, which document the
occurrence of incidents in a given area over months or years. By uniformly
sampling a representative subset of this data, we can test the generated shift
plan's performance. This approach assumes that past incident patterns will
persist in the future. Historical data provide the most reliable means of
simulating incident occurrences accurately.

The second approach involves defining a distribution that generates incidents
based on prior knowledge. For instance, we may observe that incidents primarily
occur during early mornings, around lunchtime, or at transportation hubs due to
commuting patterns. Conversely, we may notice a lower incidence rate during
nighttime compared to the daytime.

While the first approach more accurately depicts the occurrence of incidents in
the area of interest, obtaining such historical data can be challenging and
time-consuming. Moreover, these data often remain confidential, making it
difficult to access them, for example from other EMS organizations.

Therefore, for the purposes of this thesis, we will adopt the second approach,
generating representative incident sets using a predefined distribution. This
approach offers greater flexibility, allowing us to experiment with different
distributions and simulate various scenarios, including unexpected or extreme
situations.

Finally, with all this information at our disposal, we can now shift our focus
towards evaluating the performance of the shift plan against a set of incident
sets. In order to measure performance, we will assess the ratio of successfully
handled incidents to the total number of incidents in the set. A higher number
of handled incidents and lower costs indicate a better shift plan. While this
approach is reasonable, we will take a slightly different route in this thesis.
Since this thesis is associated with the Computer-Aided Dispatch System
Organization Logis Solutions s. r. o. (Logis), which employs advanced solutions
for existing EMS, Logis has the advantage of having historical incident data
sets available. This leads us to examine the success rates achieved by each
incident set on a given day. As the proposed solutions in this thesis may be
utilized in the production software developed by Logis for their EMS clients,
it would be ideal to generate a shift plan that maintains or surpasses the
success rates indicated by the historical data, while concurrently reducing
costs. Therefore, the success rate will be provided for each incident set, and
our optimization will solely focus on minimizing the cost.

Introducing the concept of success rate provides a useful framework for
considering a shift plan as either valid or invalid. A shift plan is deemed
valid if it can meet the given success rate, indicating its ability to satisfy
the incident requirements. Conversely, a shift plan is considered invalid if it
fails to meet the specified success rate. It is worth noting that there may be
scenarios where no shift plan can handle the incidents to meet the desired
success rate, resulting in all shift plans being invalid. However, this
particular case is not our primary concern, as the success rates derived from
historical data are based on shift plans employed on previous days, which were
not necessarily designed using highly sophisticated methods. Therefore, the
probability of encountering such a situation in high-quality historical data is
very low. Nonetheless, even in such scenario the proposed solutions will
prioritize maximizing the success rate to the greatest extent possible.

\section{Evaluating success rate of a shift plan}

Our primary objective is to ensure that the evaluation of the shift plan
closely reflects real-world conditions. It is essential that the success rate
of a shift plan, as determined by a given incident set and specific ambulances,
closely aligns with its real-world performance. To achieve this, we will employ
evaluation strategies that mirror those used in actual ambulance dispatching.

The most direct and flexible approach is to develop a simulation that emulates
the real-world dispatching of ambulances to incidents based on the shift plan.
This simulation will also incorporate the handling of incidents at the
occurrence location, as well as the travel to the hospital and return to the
depot. In reality, ambulance dispatching decisions are guided by a set of
rules. While these rules can become quite complex, often requiring approval
from a dispatcher, we can devise our own rules that closely approximate
real-world dispatching practices. By doing so, we can ensure that the
probabilities of dispatching in the simulation closely mirror those in the real
world and are easier to work with and simulate. Leveraging Logis's extensive
expertise as one of the top CAD dispatchers in the market, Logis has derived
the following abstracted rules. If multiple ambulances satisfy a given rule,
the selection process will follow the subsequent rules in the specified order.

\begin{enumerate}[(1)]
    \item Rule of Availability: Give priority to ambulances that are free, either
          stationed at the depot or returning from a hospital after completing an
          incident.
    \item Rule of Promptness: Prioritize the ambulance with the earliest estimated
          arrival time to the incident scene.
    \item Rule of Workload Distribution: Favor ambulances with the least overall active
          time, ensuring a fair distribution of workload among all available ambulances.
    \item Rule of Cost: If multiple ambulances can handle an incident equally well,
          choose the one with the lowest operating cost.
    \item If still more than one ambulance satisfies all the above rules, just choose one
          at random. In real life, this will be dispatcher's choice.
\end{enumerate}

In addition to the previously mentioned rules, before selecting the best
ambulance for an incident, we must ensure that the ambulance satisfies a set of
conditions. These conditions determine whether a particular ambulance is
capable of handling the incident. The conditions are as follows:

\begin{enumerate}[(1)]
    \item Time for Response: The ambulance must have sufficient time to travel from its
          current location to the incident within the maximum response time specified for
          the incident type.
    \item Duration at Incident: The ambulance must have enough time available to remain
          at the incident location for the expected duration, which is also determined by
          the incident type.
    \item Travel to Hospital: Sufficient time must be available for the ambulance to
          travel from the incident location to the nearest hospital.
    \item Patient Delivery: The ambulance must have enough time to transport the patient
          to the hospital, considering the specific duration required based on the
          incident type.
\end{enumerate}

It is crucial to ensure that the assigned ambulance can complete all the
necessary tasks outlined above within the allocated shift interval. By
verifying these conditions, we can determine the suitability of an ambulance
for a given incident, ensuring that it has the required time to carry out its
responsibilities effectively.

It can happen, that no ambulances can handle given incident based on above
conditions. In such a case, the incident is declared as unhandled, and the
success rate ration must be updated appropriately. This incident is therefore
ignored and no action is done.

Once the best ambulance is selected, the incident is assigned to that
ambulance, and the ambulance proceeds with handling the incident.

In the simulation, all incidents from the incidents set are processed
sequentially, one by one, and the best ambulance is selected solely based on
the above rules and conditions. Evaluating the incidents one by one closely
resembles the functioning of a shift plan in the real world, not exploiting the
bigger picture but only deciding on local information.

The accuracy and quality of the success rate obtained from the simulation are
heavily influenced by the calculated durations for various stages of incident
handling, including ambulance response time, incident handling at the scene,
patient transfer to the hospital, handling of the incident at the hospital, and
the estimated time required to return to the depot. To accurately calculate
these durations, a reliable distance calculator is essential.

One approach to achieve this is by discretizing the area of interest and
precalculating the distances for all pairs of locations, storing them in a
distance matrix. When a distance request is made, the distance calculator
simply retrieves the precalculated distance for the requested locations. The
time required can then be calculated using the velocity of the ambulance.
However, it is important to note that this approach does not consider factors
such as traffic or the type of route taken. A more appropriate approach might
be to precalculate not the estimated distance but the estimated duration, which
also eliminates the need for the ambulance's velocity information. To obtain
reasonable precalculated duration, Here or Google map services might be great
candidates. These durations can also be recalculated to better incorporate
these factors, such as traffic condition or road closure etc ...

Another factor to account for which might negatively influence the quality of
yielded success rate is that the variability of durations in real-life
scenarios vary. Factors such as traffic conditions, road closures, and
unexpected events can cause variations in ambulance response times, incident
handling durations, and patient transfer times. Therefore, because these
durations may vary in the real world, introducing stochastic factors to
simulate their variability could lead to improvements in estimating the success
rate. Despite that, given the necessity of running the simulation multiple
times, it is more crucial to ensure that the simulation effectively captures
real-life scenarios. Introducing additional stochastic elements may also
introduce unnecessary unpredictability to the simulation. Therefore, for the
sake of efficiency and reliability, the simulation does not incorporate such
stochastic factors.

\section{Problem formalization}
As the problem above is described, it is clear we have to find the most optimal
shift plan $s_o$ from set of all possible shift plans $S^T$, where $T$ is a set
of allowed time intervals, against given incident sets $I$. Most optimal means
it has to be valid,

\[
    \text{successRate}(s_o, I) \geq
    \text{givenSuccessRate}(I),
\]

and has the least possible cost over all valid shift plans $S_v$,

\[
    \forall s_v \in S_v: \text{cost}(s_o) \leq \text{cost}(s_v),
\]

defined,

\[
    S_v = \{ s_v \in S^I | \text{successRate}(s_v, I) \geq \text{givenSuccessRate}(I) \}.
\]

If there doesn't exist any shift plan in $S^I$ which satisfies given success
rate, the most optimal is then the shift plan with the highest success rate and
at the same time having the least cost. Let denote

\[
    S_r = \{s_r \in S^I | \text{successRate}(s_r, I) \geq \text{successRate}(s, I), \forall s \in S^I\}
\]

as a set of all shift plans with the highest success rate. The optimal $s_o \in
    S_r$ is now defined as:

\[
    \forall s_r \in S_r: \text{cost}(s_o, I) \leq \text{cost}(s_r, I).
\]

Note, that this definition of optimal shift plan allows for multiple optimal
solutions. We can therefore denote set of all these optimal solutions as $S_o$.

\section{Exhaustive solution}

The most straightforward algorithm for finding the most optimal solution is to
exhaustively enumerate over all possible shift plans by brute force, holding
some global best shift plan so far and updating it in each iteration against
current shift plan. After going through every possible shift plan we can then
be certain that we have found the most optimal one.

\newpage

\begin{algorithmic}
    \STATE \textbf{Algorithm} ExhaustiveSolution
    \STATE \textbf{Input:} $S^T$, givenSuccessRate($I^T$)
    \STATE \textbf{Output:} $s_o$

    \STATE bestSoFar = $s_0 \in S^T$

    \FOR{$i \in \{ 1, 2, ..., |S^T| \}$}
    \IF{$$}
    \STATE Perform some operation
    \ELSE
    \STATE Perform a different operation
    \ENDIF
    \ENDFOR

    \WHILE{condition is met}
    \STATE Do something
    \ENDWHILE

    \STATE \textbf{Return} final result
\end{algorithmic}